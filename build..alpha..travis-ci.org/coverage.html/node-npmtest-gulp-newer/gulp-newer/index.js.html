<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-gulp-newer/gulp-newer/index.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-gulp-newer">npmtest-gulp-newer (v0.0.1)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-gulp-newer/gulp-newer/index.js</span></h1>
    <h2>
        
        Statements: <span class="metric">14.43% <small>(14 / 97)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 70)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 11)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">14.43% <small>(14 / 97)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-gulp-newer/gulp-newer/</a> &#187; index.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231</td><td class="line-coverage"><span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">var Transform = require('stream').Transform;
var fs = require('fs');
var path = require('path');
var util = require('util');
var glob = require('glob');
&nbsp;
var Q = require('kew');
var gutil = require('gulp-util');
&nbsp;
var PluginError = gutil.PluginError;
&nbsp;
var PLUGIN_NAME = 'gulp-newer';
&nbsp;
<span class="fstat-no" title="function not covered" >function Newer(options) {</span>
<span class="cstat-no" title="statement not covered" >  Transform.call(this, {objectMode: true});</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (!options) {</span>
<span class="cstat-no" title="statement not covered" >    throw new PluginError(PLUGIN_NAME,</span>
      'Requires a dest string or options object');
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (typeof options === 'string') {</span>
<span class="cstat-no" title="statement not covered" >    options = {dest: options};</span>
  } else <span class="cstat-no" title="statement not covered" >if (options.dest &amp;&amp; typeof options.dest !== 'string') {</span>
<span class="cstat-no" title="statement not covered" >    throw new PluginError(PLUGIN_NAME, 'Requires a dest string');</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (options.ext &amp;&amp; typeof options.ext !== 'string') {</span>
<span class="cstat-no" title="statement not covered" >    throw new PluginError(PLUGIN_NAME, 'Requires ext to be a string');</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (options.map &amp;&amp; typeof options.map !== 'function') {</span>
<span class="cstat-no" title="statement not covered" >    throw new PluginError(PLUGIN_NAME, 'Requires map to be a function');</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (!options.dest &amp;&amp; !options.map) {</span>
<span class="cstat-no" title="statement not covered" >    throw new PluginError(PLUGIN_NAME, 'Requires either options.dest or options.map or both');</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (options.extra) {</span>
<span class="cstat-no" title="statement not covered" >    if (typeof options.extra === 'string') {</span>
<span class="cstat-no" title="statement not covered" >      options.extra = [options.extra];</span>
    } else <span class="cstat-no" title="statement not covered" >if (!Array.isArray(options.extra)) {</span>
<span class="cstat-no" title="statement not covered" >      throw new PluginError(PLUGIN_NAME, 'Requires options.extra to be a string or array');</span>
    }
  }
&nbsp;
  /**
   * Path to destination directory or file.
   * @type {string}
   */
<span class="cstat-no" title="statement not covered" >  this._dest = options.dest;</span>
&nbsp;
  /**
   * Optional extension for destination files.
   * @type {string}
   */
<span class="cstat-no" title="statement not covered" >  this._ext = options.ext;</span>
&nbsp;
  /**
   * Optional function for mapping relative source files to destination files.
   * @type {function(string): string}
   */
<span class="cstat-no" title="statement not covered" >  this._map = options.map;</span>
&nbsp;
  /**
   * Promise for the dest file/directory stats.
   * @type {[type]}
   */
<span class="cstat-no" title="statement not covered" >  this._destStats = this._dest ? Q.nfcall(fs.stat, this._dest) : Q.resolve(null);</span>
&nbsp;
  /**
   * If the provided dest is a file, we want to pass through all files if any
   * one of the source files is newer than the dest.  To support this, source
   * files need to be buffered until a newer file is found.  When a newer file
   * is found, buffered source files are flushed (and the `_all` flag is set).
   * @type {[type]}
   */
<span class="cstat-no" title="statement not covered" >  this._bufferedFiles = null;</span>
&nbsp;
  /**
   * Indicates that all files should be passed through.  This is set when the
   * provided dest is a file and we have already encountered a newer source
   * file.  When true, all remaining source files should be passed through.
   * @type {boolean}
   */
<span class="cstat-no" title="statement not covered" >  this._all = false;</span>
&nbsp;
  /**
   * Indicates that there are extra files (configuration files, etc.)
   * that are not to be fed into the stream, but that should force
   * all files to be rebuilt if *any* are older than one of the extra
   * files.
   */
<span class="cstat-no" title="statement not covered" >  this._extraStats = null;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (options.extra) {</span>
<span class="cstat-no" title="statement not covered" >    var extraFiles = [];</span>
<span class="cstat-no" title="statement not covered" >    for (var i = 0; i &lt; options.extra.length; ++i) {</span>
<span class="cstat-no" title="statement not covered" >      extraFiles.push(Q.nfcall(glob, options.extra[i]));</span>
    }
<span class="cstat-no" title="statement not covered" >    this._extraStats = Q.all(extraFiles)</span>
      .then(<span class="fstat-no" title="function not covered" >function(fileArrays) {</span>
        // First collect all the files in all the glob result arrays
<span class="cstat-no" title="statement not covered" >        var allFiles = [];</span>
<span class="cstat-no" title="statement not covered" >        var i;</span>
<span class="cstat-no" title="statement not covered" >        for (i = 0; i &lt; fileArrays.length; ++i) {</span>
<span class="cstat-no" title="statement not covered" >          allFiles = allFiles.concat(fileArrays[i]);</span>
        }
<span class="cstat-no" title="statement not covered" >        var extraStats = [];</span>
<span class="cstat-no" title="statement not covered" >        for (i = 0; i &lt; allFiles.length; ++i) {</span>
<span class="cstat-no" title="statement not covered" >          extraStats.push(Q.nfcall(fs.stat, allFiles[i]));</span>
        }
<span class="cstat-no" title="statement not covered" >        return Q.all(extraStats);</span>
      })
      .then(<span class="fstat-no" title="function not covered" >function(resolvedStats) {</span>
        // We get all the file stats here; find the *latest* modification.
<span class="cstat-no" title="statement not covered" >        var latestStat = resolvedStats[0];</span>
<span class="cstat-no" title="statement not covered" >        for (var j = 1; j &lt; resolvedStats.length; ++j) {</span>
<span class="cstat-no" title="statement not covered" >          if (resolvedStats[j].mtime &gt; latestStat.mtime) {</span>
<span class="cstat-no" title="statement not covered" >            latestStat = resolvedStats[j];</span>
          }
        }
<span class="cstat-no" title="statement not covered" >        return latestStat;</span>
      })
      .fail(<span class="fstat-no" title="function not covered" >function(error) {</span>
<span class="cstat-no" title="statement not covered" >        if (error &amp;&amp; error.path) {</span>
<span class="cstat-no" title="statement not covered" >          throw new PluginError(PLUGIN_NAME, 'Failed to read stats for an extra file: ' + error.path);</span>
        } else {
<span class="cstat-no" title="statement not covered" >          throw new PluginError(PLUGIN_NAME, 'Failed to stat extra files; unknown error: ' + error);</span>
        }
      });
  }
&nbsp;
}
util.inherits(Newer, Transform);
&nbsp;
&nbsp;
/**
 * Pass through newer files only.
 * @param {File} srcFile A vinyl file.
 * @param {string} encoding Encoding (ignored).
 * @param {function(Error, File)} done Callback.
 */
Newer.prototype._transform = <span class="fstat-no" title="function not covered" >function(srcFile, encoding, done) {</span>
<span class="cstat-no" title="statement not covered" >  if (!srcFile || !srcFile.stat) {</span>
<span class="cstat-no" title="statement not covered" >    done(new PluginError(PLUGIN_NAME, 'Expected a source file with stats'));</span>
<span class="cstat-no" title="statement not covered" >    return;</span>
  }
<span class="cstat-no" title="statement not covered" >  var self = this;</span>
<span class="cstat-no" title="statement not covered" >  Q.resolve([this._destStats, this._extraStats])</span>
    .spread(<span class="fstat-no" title="function not covered" >function(destStats, extraStats) {</span>
<span class="cstat-no" title="statement not covered" >      if ((destStats &amp;&amp; destStats.isDirectory()) || self._ext || self._map) {</span>
        // stat dest/relative file
<span class="cstat-no" title="statement not covered" >        var relative = srcFile.relative;</span>
<span class="cstat-no" title="statement not covered" >        var ext = path.extname(relative);</span>
<span class="cstat-no" title="statement not covered" >        var destFileRelative = self._ext ?</span>
          relative.substr(0, relative.length - ext.length) + self._ext :
          relative;
<span class="cstat-no" title="statement not covered" >        if (self._map) {</span>
<span class="cstat-no" title="statement not covered" >          destFileRelative = self._map(destFileRelative);</span>
        }
<span class="cstat-no" title="statement not covered" >        var destFileJoined = self._dest ?</span>
          path.join(self._dest, destFileRelative) : destFileRelative;
<span class="cstat-no" title="statement not covered" >        return Q.all([Q.nfcall(fs.stat, destFileJoined), extraStats]);</span>
      } else {
        // wait to see if any are newer, then pass through all
<span class="cstat-no" title="statement not covered" >        if (!self._bufferedFiles) {</span>
<span class="cstat-no" title="statement not covered" >          self._bufferedFiles = [];</span>
        }
<span class="cstat-no" title="statement not covered" >        return [destStats, extraStats];</span>
      }
    }).fail(<span class="fstat-no" title="function not covered" >function(err) {</span>
<span class="cstat-no" title="statement not covered" >      if (err.code === 'ENOENT') {</span>
        // dest file or directory doesn't exist, pass through all
<span class="cstat-no" title="statement not covered" >        return Q.resolve([null, this._extraStats]);</span>
      } else {
        // unexpected error
<span class="cstat-no" title="statement not covered" >        return Q.reject(err);</span>
      }
    }).spread(<span class="fstat-no" title="function not covered" >function(destFileStats, extraFileStats) {</span>
<span class="cstat-no" title="statement not covered" >      var newer = !destFileStats || srcFile.stat.mtime &gt; destFileStats.mtime;</span>
      // If *any* extra file is newer than a destination file, then ALL
      // are newer.
<span class="cstat-no" title="statement not covered" >      if (extraFileStats &amp;&amp; extraFileStats.mtime &gt; destFileStats.mtime) {</span>
<span class="cstat-no" title="statement not covered" >        newer = true;</span>
      }
<span class="cstat-no" title="statement not covered" >      if (self._all) {</span>
<span class="cstat-no" title="statement not covered" >        self.push(srcFile);</span>
      } else <span class="cstat-no" title="statement not covered" >if (!newer) {</span>
<span class="cstat-no" title="statement not covered" >        if (self._bufferedFiles) {</span>
<span class="cstat-no" title="statement not covered" >          self._bufferedFiles.push(srcFile);</span>
        }
      } else {
<span class="cstat-no" title="statement not covered" >        if (self._bufferedFiles) {</span>
          // flush buffer
<span class="cstat-no" title="statement not covered" >          self._bufferedFiles.forEach(<span class="fstat-no" title="function not covered" >function(file) {</span></span>
<span class="cstat-no" title="statement not covered" >            self.push(file);</span>
          });
<span class="cstat-no" title="statement not covered" >          self._bufferedFiles.length = 0;</span>
          // pass through all remaining files as well
<span class="cstat-no" title="statement not covered" >          self._all = true;</span>
        }
<span class="cstat-no" title="statement not covered" >        self.push(srcFile);</span>
      }
<span class="cstat-no" title="statement not covered" >      done();</span>
    }).fail(done).end();
&nbsp;
};
&nbsp;
&nbsp;
/**
 * Remove references to buffered files.
 * @param {function(Error)} done Callback.
 */
Newer.prototype._flush = <span class="fstat-no" title="function not covered" >function(done) {</span>
<span class="cstat-no" title="statement not covered" >  this._bufferedFiles = null;</span>
<span class="cstat-no" title="statement not covered" >  done();</span>
};
&nbsp;
&nbsp;
/**
 * Only pass through source files that are newer than the provided destination.
 * @param {Object} options An options object or path to destination.
 * @return {Newer} A transform stream.
 */
module.exports = <span class="fstat-no" title="function not covered" >function(options) {</span>
<span class="cstat-no" title="statement not covered" >  return new Newer(options);</span>
};
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Tue Apr 11 2017 12:42:18 GMT+0000 (UTC)</div>
</div>
</body>
</html>
